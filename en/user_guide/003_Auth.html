<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="../github.css" type="text/css" />
</head>
<body>
<h1 id="authentication-model">Authentication model</h1>
<p>Personim use the OAuth2 Authorization Framework, the industry standard, to allow many types of application to access resources on Personium in secure way.</p>
<p>In addition, Personium provides authorization flow based on the trust between cells.</p>
<h2 id="access-token">Access Token</h2>
<p>To let client access to the resource, access token is required.<br />
There are two types of access token and refresh token. Trans-cell token is used for the authorization based on the trust between cells.</p>
<table>
<thead>
<tr class="header">
<th align="left">Token Type</th>
<th align="left">Description</th>
<th align="left">Expiration Date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Cell local Token</td>
<td align="left">Access token valid in the cell which issued the token.</td>
<td align="left">1 hour</td>
</tr>
<tr class="even">
<td align="left">Trans-cell Token</td>
<td align="left">Access token valid in the target cell which is specified by the issued cell.</td>
<td align="left">1 hour</td>
</tr>
<tr class="odd">
<td align="left">Refresh Token</td>
<td align="left">Token used for refreshing the token which already issued</td>
<td align="left">24 hour</td>
</tr>
</tbody>
</table>
<h5 id="note">Note</h5>
<ul>
<li>To accept trans-cell token, configuration (&quot;external cell&quot;, &quot;relation&quot;, &quot;external role&quot;...etc) is required.</li>
<li>To accept trans-cell token issued by the different server, X509 certificate need to be signed by same CA as issued server.</li>
</ul>
<h2 id="grant-flow">Grant Flow</h2>
<p>Before initiating flow, please <a href="https://personium.github.io/en/user_guide/004_Client_auth.html">register client</a> if client authentication is required.</p>
<h4 id="resouce-owner-password-credentials-grant">Resouce Owner Password Credentials Grant</h4>
<p>1.Client send requests to the token endpoint of the cell which contain the resource with following.</p>
<ul>
<li>Username and Password of the account used for authentication,in the request body.</li>
<li>Client authentication information with authorization header or in request body.</li>
</ul>
<p>2.As a response, access token with refresh token will be returned.</p>
<h5 id="note-1">Note</h5>
<p>For Resource Owner Password Credentials, it is also possible to allow access from non-registered client.</p>
<h2 id="implicit-grant">Implicit Grant</h2>
<p>1.Browser send GET request to the authorization endpoint of the cell with redirect uri defined in client registration and required parameters.Then, endpoint returns HTML Page which contains the login form.<br />
2.Resource owner provide account name and password to the form and press login. Then, the browser send POST request to the authorization endpoint.<br />
The endpoint returns redirection response to the redirect uri with access token in fragment.<br />
3.Browser follows redirection and access to redirection uri and retrieve HTML with embedded script.<br />
4.Browser execute embedded script and extract the token.</p>
<h5 id="note-2">Note</h5>
<p>You can modify look &amp; feel of the form by editing core/src/main/resources/html/authform.html.</p>
<h2 id="exchange-token">Exchange Token</h2>
<p>By Sending the trans-cell token to the token endpoint of the target cell, the cell local token valid in the cell will be returned.</p>
<h2 id="refresh-token">Refresh Token</h2>
<p>To refresh token, send refresh token to the token endpoint. Then, new token and refrsh token will be returned.<br />
It is possible to refresh the token if access token is not expired.</p>
</body>
</html>
